<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/ApprovalTests/mdsource/EnvironmentSpecificTests.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

<!-- toc -->
## Contents

  * [EnvironmentSpecificTest](#environmentspecifictest)
  * [MachineSpecificReporter](#machinespecificreporter)<!-- endToc -->


## EnvironmentSpecificTest

Sometimes you need Additional Information in the Approval Output File Name.

ApprovalTests allows for `ClassName.MethodName.AdditionalInforamtion.approved.extension`

```cs
using(var cleanup = NamerFactory.AsEnvironmentSpecificTest(()=> "Any.Additional.Data"))
{
}
```

As this will clean up the additional information regardless of the test execution.

There are a few convenience functions in `ApprovalResults` setup for the common situations:

 * UniqueForDotNetVersion
 * UniqueForMachineName
 * UniqueForOs
 * UniqueForRuntime
 * GetUserName


## MachineSpecificReporter

Some things will always be different if you run them on Windows 7 versus Windows 10 (for example: WinForms will always render differently). Approval Test has a feature to handle this situation by including the OS in approvals file name so you have a different approval file for each OS.

If you are using a machine specific name in your approval tests
for example:

<!-- snippet: unique_for_os -->
<a id='snippet-unique_for_os'></a>
```cs
using (ApprovalResults.UniqueForOs())
{
    Approvals.Verify("Data");
}
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalResultsTest.cs#L35-L40' title='Snippet source file'>snippet source</a> | <a href='#snippet-unique_for_os' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

This can produce files such as:

<!-- snippet: ApprovalsFilenameTest.TestSimilarFiles.approved.txt -->
<a id='snippet-ApprovalsFilenameTest.TestSimilarFiles.approved.txt'></a>
```txt
Like LockDownTests.TestExceptions.Microsoft_Windows_10_Education.approved.txt

LockDownTests.TestExceptions.Mac.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_10_Enterprise.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_10_Home_N.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_10_Pro.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_11_Enterprise.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_11_Pro.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_Server_2016_Datacenter.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_Server_2019_Datacenter.approved.txt
LockDownTests.TestExceptions.Microsoft_Windows_Server_2022_Datacenter.approved.txt
LockDownTests.TestExceptions.Windows_7.approved.txt
LockDownTests.TestExceptions.Windows_8.approved.txt
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalsFilenameTest.TestSimilarFiles.approved.txt#L1-L13' title='Snippet source file'>snippet source</a> | <a href='#snippet-ApprovalsFilenameTest.TestSimilarFiles.approved.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

If this is run on a new machine, it could produce a new approval file. This can be confusing as you might not remember what the old system used to produce.

<!-- snippet: use_MachineSpecificReporter -->
<a id='snippet-use_MachineSpecificReporter'></a>
```cs
[UseReporter(typeof(MachineSpecificReporter))]
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalResultsTest.cs#L2-L4' title='Snippet source file'>snippet source</a> | <a href='#snippet-use_MachineSpecificReporter' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

If you use a MachineSpecificReporter and the existing approval file does not exist (or is empty), it will search or the last approved version from a different machine and copy it over as a starting point. This will always start with a line:

```
Copied from: EmailTest.Testname.Microsoft_Windows_10_Pro.approved.eml
```

This makes it easier to understand how this system differs from the last system.


---

[Back to User Guide](readme.md#top)
