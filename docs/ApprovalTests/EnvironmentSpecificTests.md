<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/ApprovalTests/mdsource/EnvironmentSpecificTests.source.md
To change this file edit the source file and then execute run_markdown.cmd.
-->

<!-- toc -->
## Contents

  * [EnvironmentSpecificTest](#environmentspecifictest)
  * [MachineSpecificReporter](#machinespecificreporter)<!-- endtoc -->


## EnvironmentSpecificTest

Sometimes you need Additional Information in the Approval Output File Name.

ApprovalTests allows for `ClassName.MethodName.AdditionalInforamtion.approved.extension`

```cs
using(var cleanup = NamerFactory.AsEnvironmentSpecificTest(()=> "Any.Additional.Data"))
{
}
```

As this will clean up the additional information regardless of the test execution.

There are a few convenience functions in `ApprovalResults` setup for the common situations:

 * UniqueForDotNetVersion
 * UniqueForMachineName
 * UniqueForOs
 * UniqueForRuntime
 * GetUserName


## MachineSpecificReporter

Some things will always be different if you run them on Windows 7 versus Windows 10 (for example: WinForms will always render differently). Approval Test has a feature to handle this situation by including the OS in approvals file name so you have a different approval file for each OS.

If you are using a machine specific name in your approval tests
for example:

<!-- snippet: unique_for_os -->
<a id='snippet-unique_for_os'/></a>
```cs
using (ApprovalResults.UniqueForOs())
{
    Approvals.Verify("Data");
}
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalResultsTest.cs#L21-L26' title='File snippet `unique_for_os` was extracted from'>snippet source</a> | <a href='#snippet-unique_for_os' title='Navigate to start of snippet `unique_for_os`'>anchor</a></sup>
<!-- endsnippet -->

This can produce files such as:
<!-- snippet: ApprovalsFilenameTest.TestSimilarFiles.approved.txt -->
<a id='snippet-ApprovalsFilenameTest.TestSimilarFiles.approved.txt'/></a>
```txt
Like EmailTest.Testname.Microsoft_Windows_10_Education.approved.eml

EmailTest.Testname.Microsoft_Windows_10_Home_N.approved.eml
EmailTest.Testname.Microsoft_Windows_10_Pro.approved.eml
EmailTest.Testname.Microsoft_Windows_Server_2016_Datacenter.approved.eml
EmailTest.Testname.Microsoft_Windows_Server_2019_Datacenter.approved.eml
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalsFilenameTest.TestSimilarFiles.approved.txt#L1-L6' title='File snippet `ApprovalsFilenameTest.TestSimilarFiles.approved.txt` was extracted from'>snippet source</a> | <a href='#snippet-ApprovalsFilenameTest.TestSimilarFiles.approved.txt' title='Navigate to start of snippet `ApprovalsFilenameTest.TestSimilarFiles.approved.txt`'>anchor</a></sup>
<!-- endsnippet -->

If this is run on a new machine, it could produce a new approval file. This can be confusing as you might not remember what the old system used to produce.

<!-- snippet: use_MachineSpecificReporter -->
<a id='snippet-use_machinespecificreporter'/></a>
```cs
[UseReporter(typeof(MachineSpecificReporter))]
```
<sup><a href='/src/ApprovalTests.Tests/Namer/ApprovalResultsTest.cs#L8-L10' title='File snippet `use_machinespecificreporter` was extracted from'>snippet source</a> | <a href='#snippet-use_machinespecificreporter' title='Navigate to start of snippet `use_machinespecificreporter`'>anchor</a></sup>
<!-- endsnippet -->

If you use a MachineSpecificReporter and the existing approval file does not exist (or is empty), it will search or the last approved version from a different machine and copy it over as a starting point. This will always start with a line:

```
Copied from: EmailTest.Testname.Microsoft_Windows_10_Pro.approved.eml
```

This makes it easier to understand how this system differs from the last system.


---

[Back to User Guide](readme.md#top)
